> NODE_ENV=production node dist/index.cjs

OpenAI Integration initialized successfully (GPT-4o)
6:00:24 PM [express] serving on port 5000
error: column "hide_from_website" does not exist
    at /app/dist/index.cjs:70:13330
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async /app/dist/index.cjs:76:37968
    at async zS.getActivities (/app/dist/index.cjs:110:37244)
    at async Ioe (/app/dist/index.cjs:942:28020) {
  length: 118,
  severity: 'ERROR',
  code: '42703',
6:00:25 PM [express] POST /api/auth/logout 200 in 10ms :: {"success":true}
6:00:26 PM [express] GET /api/settings/popupAppearance 401 in 1ms :: {"error":"Giriş yapmaniz gerekiyor"}
6:00:26 PM [express] GET /api/settings/brandSettings 304 in 2ms :: {"key":"brandSettings"}
6:00:30 PM [express] POST /api/auth/login 200 in 21ms :: {"user":{"id":11,"tenantId":10,"username":"skyfethiye","email":"<REDACTED>","name":"Metin Işık","phone":"05384944505","companyName":"Sky Fethiye","membershipType":"trial","membershipStartDate":"2026-01-14T08:18:33.116Z","membershipEndDate":null,"planId":null,"isActive":true,"isSuspended":false,"suspendReason":null,"isSystemProtected":false,"maxActivities":50,"maxReservationsPerMonth":1000,"lastLoginAt":"2026-02-07T17:39:07.135Z","loginCount":51,"createdBy":null,"notes":"Sky Fethiye acentasi yönetiçi hesabı","createdAt":"2026-01-14T08:18:33.117Z","updatedAt":"2026-01-14T08:18:33.117Z"},"permissions":["activities.view","activities.manage","agencies.view","agencies.manage","bot.view","bot.manage","calendar.view","calendar.manage","capacity.view","dashboard.view","finance.view","finance.manage","reports.view","reports.export","reservations.view","reservations.create","reservations.edit","reservations.delete","settings.view","settings.manage","settings.templates.manage","subscription.view","subscription.manage","users.view","users.manage","whatsapp.view","whatsapp.manage"],"roles":[4],"tenant":{"id":10,"name":"Sky Fethiye","slug":"sky-fethiye","primaryColor":"262 83% 58%","accentColor":"142 76% 36%","logoUrl":"/uploads/1769257063315-159344489.png"}}
6:00:30 PM [express] GET /api/website/smartur-settings 304 in 5ms :: {"footer_logo_url":"/uploads/1769621221069-156607974.png","footer_link_url":"https://www.mysmartur.com","footer_enabled":true}
6:00:30 PM [express] GET /api/in-app-notifications 304 in 20ms :: []
  detail: undefined,
  hint: undefined,
  position: '560',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3716',
  routine: 'errorMissingColumn'
}
/app/dist/index.cjs:70
`);Lp.write(oO.format.apply(oO,e))}}Object.defineProperty(ha.exports,"isWin",{get:function(){return Gf},set:function(i){Gf=i}});ha.exports.warnTo=function(i){var e=Lp;return Lp=i,e};ha.exports.getFileName=function(i){var e=i||process.env,t=e.PGPASSFILE||(Gf?sO.join(e.APPDATA||"./","postgresql","pgpass.conf"):sO.join(e.HOME||"./",".pgpass"));return t};ha.exports.usePgPass=function(i,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Gf?!0:(e=e||"<unkn>",YQ(i.mode)?i.mode&(GQ|VQ)?(Pw('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(Pw('WARNING: password file "%s" is not a plain file',e),!1))};var ZQ=ha.exports.match=function(i,e){return Qc.slice(0,-1).reduce(function(t,r,n){return n==1&&Number(i[r]||KQ)===Number(e[r])?t&&!0:t&&(e[r]==="*"||e[r]===i[r])},!0)};ha.exports.getPassword=function(i,e,t){var r,n=e.pipe(HQ());function a(p){var m=XQ(p);m&&eY(m)&&ZQ(i,m)&&(r=m[JQ],n.end())}var s=function(){e.destroy(),t(r)},l=function(p){e.destroy(),Pw("WARNING: error on reading file: %s",p),t(void 0)};e.on("error",l),n.on("data",a).on("end",s).on("error",l)};var XQ=ha.exports.parseLine=function(i){if(i.length<11||i.match(/^\s+#/))return null;for(var e="",t="",r=0,n=0,a=0,s={},l=!1,p=function(h,u,c){var o=i.substring(u,c);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(o=o.replace(/\\([:\\])/g,"$1")),s[Qc[h]]=o},m=0;m<i.length-1;m+=1){if(e=i.charAt(m+1),t=i.charAt(m),l=r==Ew-1,l){p(r,n);break}m>=0&&e==":"&&t!=="\\"&&(p(r,n,m+1),n=m+2,r+=1)}return s=Object.keys(s).length===Ew?s:null,s},eY=ha.exports.isValidEntry=function(i){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},t=0;t<Qc.length;t+=1){var r=e[t],n=i[Qc[t]]||"",a=r(n);if(!a)return!1}return!0}});var uO=R((ape,Cw)=>{"use strict";var npe=require("path"),lO=require("fs"),Vf=cO();Cw.exports=function(i,e){var t=Vf.getFileName();lO.stat(t,function(r,n){if(r||!Vf.usePgPass(n,t))return e(void 0);var a=lO.createReadStream(t);Vf.getPassword(i,a,e)})};Cw.exports.warnTo=Vf.warnTo});var fO=R((spe,mO)=>{"use strict";var tY=require("events").EventEmitter,pO=Hc(),Rw=Rj(),iY=Bf(),rY=Xb(),dO=Hj(),nY=Mp(),aY=Iw(),sY=Yb(),Wf=class extends tY{constructor(e){super(),this.connectionParameters=new rY(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let t=e||{};this._Promise=t.Promise||global.Promise,this._types=new iY(t.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!t.enableChannelBinding,this.connection=t.connection||new aY({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||nY.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=r=>{process.nextTick(()=>{r.handleError(e,this.connection)})};this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){let t=this,r=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let n=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(n)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{r._ending=!0,r.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",function(){t.ssl?r.requestSsl():r.startup(t.getStartupConf())}),r.on("sslconnect",function(){r.startup(t.getStartupConf())}),this._attachListeners(r),r.once("end",()=>{let n=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(n),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(n):this._handleErrorEvent(n):this._connectionError||this._handleErrorEvent(n)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,r)=>{this._connect(n=>{n?r(n):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(r=>{if(r!==void 0){if(typeof r!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=r}else this.connectionParameters.password=this.password=null;e()}).catch(r=>{t.emit("error",r)});else if(this.password!==null)e();else try{uO()(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}catch(r){this.emit("error",r)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let t=await sY.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)}catch(t){this.emit("error",t)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=Rw.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(t){this.connection.emit("error",t)}})}async _handleAuthSASLContinue(e){try{await Rw.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(t){this.connection.emit("error",t)}}_handleAuthSASLFinal(e){try{Rw.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(t){this.connection.emit("error",t)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let t=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(t);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,t={user:e.user,database:e.database},r=e.application_name||e.fallback_application_name;return r&&(t.application_name=r),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){let r=this.connection;this.host&&this.host.indexOf("/")===0?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",function(){r.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,r){return this._types.setTypeParser(e,t,r)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return pO.escapeIdentifier(e)}escapeLiteral(e){return pO.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,r){let n,a,s,l,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,a=n=e,typeof t=="function"&&(n.callback=n.callback||t)):(s=e.query_timeout||this.connectionParameters.query_timeout,n=new dO(e,t,r),n.callback||(a=new this._Promise((m,h)=>{n.callback=(u,c)=>u?h(u):m(c)}).catch(m=>{throw Error.captureStackTrace(m),m}))),s&&(p=n.callback,l=setTimeout(()=>{let m=new Error("Query read timeout");process.nextTick(()=>{n.handleError(m,this.connection)}),p(m),n.callback=()=>{};let h=this.queryQueue.indexOf(n);h>-1&&this.queryQueue.splice(h,1),this._pulseQueryQueue()},s),n.callback=(m,h)=>{clearTimeout(l),p(m,h)}),this.binary&&!n.binary&&(n.binary=!0),n._result&&!n._result._types&&(n._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"),this.connection)}),a):(this.queryQueue.push(n),this._pulseQueryQueue(),a):(process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),a)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};Wf.Query=dO;mO.exports=Wf});var vO=R((ope,yO)=>{"use strict";var oY=require("events").EventEmitter,hO=function(){},gO=(i,e)=>{let t=i.findIndex(e);return t===-1?void 0:i.splice(t,1)[0]},Nw=class{constructor(e,t,r){this.client=e,this.idleListener=t,this.timeoutId=r}},Yc=class{constructor(e){this.callback=e}};function cY(){throw new Error("Release called on client which has already been released to the pool.")}function Qf(i,e){if(e)return{callback:e,result:void 0};let t,r,n=function(s,l){s?t(s):r(l)},a=new i(function(s,l){r=s,t=l}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:n,result:a}}function lY(i,e){return function t(r){r.client=e,e.removeListener("error",t),e.on("error",()=>{i.log("additional client error after disconnection due to error",r)}),i._remove(e),i.emit("error",r,e)}}var jw=class extends oY{constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||Yf().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let r=t.client;r.ref&&r.ref();let n=t.idleListener;return this._acquireClient(r,e,n,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,t){let r=gO(this._idle,a=>a.client===e);r!==void 0&&clearTimeout(r.timeoutId),this._clients=this._clients.filter(a=>a!==e);let n=this;e.end(()=>{n.emit("remove",e),typeof t=="function"&&t()})}connect(e){if(this.ending){let n=new Error("Cannot use a pool after calling end on the pool");return e?e(n):this.Promise.reject(n)}let t=Qf(this.Promise,e),r=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new Yc(t.callback)),r;let n=(l,p,m)=>{clearTimeout(s),t.callback(l,p,m)},a=new Yc(n),s=setTimeout(()=>{gO(this._pendingQueue,l=>l.callback===n),a.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(a),r}return this.newClient(new Yc(t.callback)),r}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let r=lY(this,t);this.log("checking client timeout");let n,a=!1;this.options.connectionTimeoutMillis&&(n=setTimeout(()=>{this.log("ending client due to timeout"),a=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(s=>{if(n&&clearTimeout(n),t.on("error",r),s)this.log("client failed to connect",s),this._clients=this._clients.filter(l=>l!==t),a&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,hO);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let l=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(m=>m.client===t)!==-1&&this._acquireClient(t,new Yc((m,h,u)=>u()),r,!1)},this.options.maxLifetimeSeconds*1e3);l.unref(),t.once("end",()=>clearTimeout(l))}return this._acquireClient(t,e,r,!0)}})}_acquireClient(e,t,r,n){n&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,r),e.removeListener("error",r),t.timedOut?n&&this.options.verify?this.options.verify(e,e.release):e.release():n&&this.options.verify?this.options.verify(e,a=>{if(a)return e.release(a),t.callback(a,void 0,hO);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let r=!1;return n=>{r&&cY(),r=!0,this._release(e,t,n)}}_release(e,t,r){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",r,e),r||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let a;this.options.idleTimeoutMillis&&this._isAboveMin()&&(a=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&a.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new Nw(e,t,a)),this._pulseQueue()}query(e,t,r){if(typeof e=="function"){let a=Qf(this.Promise,e);return setImmediate(function(){return a.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),a.result}typeof t=="function"&&(r=t,t=void 0);let n=Qf(this.Promise,r);return r=n.callback,this.connect((a,s)=>{if(a)return r(a);let l=!1,p=m=>{l||(l=!0,s.release(m),r(m))};s.once("error",p),this.log("dispatching query");try{s.query(e,t,(m,h)=>{if(this.log("query dispatched"),s.removeListener("error",p),!l)return l=!0,s.release(m),m?r(m):r(void 0,h)})}catch(m){return s.release(m),r(m)}}),n.result}end(e){if(this.log("ending"),this.ending){let r=new Error("Called end on pool more than once");return e?e(r):this.Promise.reject(r)}this.ending=!0;let t=Qf(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};yO.exports=jw});var xO=R((cpe,wO)=>{"use strict";var bO=require("events").EventEmitter,uY=require("util"),Ow=Hc(),Jc=wO.exports=function(i,e,t){bO.call(this),i=Ow.normalizeQueryConfig(i,e,t),this.text=i.text,this.values=i.values,this.name=i.name,this.queryMode=i.queryMode,this.callback=i.callback,this.state="new",this._arrayMode=i.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(r){r==="row"&&(this._emitRowEvents=!0)}.bind(this))};uY.inherits(Jc,bO);var pY={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};Jc.prototype.handleError=function(i){let e=this.native.pq.resultErrorFields();if(e)for(let t in e){let r=pY[t]||t;i[r]=e[t]}this.callback?this.callback(i):this.emit("error",i),this.state="error"};Jc.prototype.then=function(i,e){return this._getPromise().then(i,e)};Jc.prototype.catch=function(i){return this._getPromise().catch(i)};Jc.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(i,e){this._once("end",i),this._once("error",e)}.bind(this)),this._promise)};Jc.prototype.submit=function(i){this.state="running";let e=this;this.native=i.native,i.native.arrayMode=this._arrayMode;let t=function(r,n,a){if(i.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),r)return e.handleError(r);e._emitRowEvents&&(a.length>1?n.forEach((s,l)=>{s.forEach(p=>{e.emit("row",p,a[l])})}):n.forEach(function(s){e.emit("row",s,a)})),e.state="end",e.emit("end",a),e.callback&&e.callback(null,a)};if(process.domain&&(t=process.domain.bind(t)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let r=(this.values||[]).map(Ow.prepareValue);if(i.namedQueries[this.name]){if(this.text&&i.namedQueries[this.name]!==this.text){let n=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return t(n)}return i.native.execute(this.name,r,t)}return i.native.prepare(this.name,this.text,r.length,function(n){return n?t(n):(i.namedQueries[e.name]=e.text,e.native.execute(e.name,r,t))})}else if(this.values){if(!Array.isArray(this.values)){let n=new Error("Query values must be an array");return t(n)}let r=this.values.map(Ow.prepareValue);i.native.query(this.text,r,t)}else this.queryMode==="extended"?i.native.query(this.text,[],t):i.native.query(this.text,t)}});var TO=R((lpe,AO)=>{"use strict";var SO;try{SO=require("pg-native")}catch(i){throw i}var dY=Bf(),_O=require("events").EventEmitter,mY=require("util"),fY=Xb(),kO=xO(),xr=AO.exports=function(i){_O.call(this),i=i||{},this._Promise=i.Promise||global.Promise,this._types=new dY(i.types),this.native=new SO({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new fY(i);i.nativeConnectionString&&(e.nativeConnectionString=i.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};xr.Query=kO;mY.inherits(xr,_O);xr.prototype._errorAllQueries=function(i){let e=t=>{process.nextTick(()=>{t.native=this.native,t.handleError(i)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};xr.prototype._connect=function(i){let e=this;if(this._connecting){process.nextTick(()=>i(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(t,r){if(e.connectionParameters.nativeConnectionString&&(r=e.connectionParameters.nativeConnectionString),t)return i(t);e.native.connect(r,function(n){if(n)return e.native.end(),i(n);e._connected=!0,e.native.on("error",function(a){e._queryable=!1,e._errorAllQueries(a),e.emit("error",a)}),e.native.on("notification",function(a){e.emit("notification",{channel:a.relname,payload:a.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),i()})})};xr.prototype.connect=function(i){if(i){this._connect(i);return}return new this._Promise((e,t)=>{this._connect(r=>{r?t(r):e()})})};xr.prototype.query=function(i,e,t){let r,n,a,s,l;if(i==null)throw new TypeError("Client was passed a null or undefined query");if(typeof i.submit=="function")a=i.query_timeout||this.connectionParameters.query_timeout,n=r=i,typeof e=="function"&&(i.callback=e);else if(a=i.query_timeout||this.connectionParameters.query_timeout,r=new kO(i,e,t),!r.callback){let p,m;n=new this._Promise((h,u)=>{p=h,m=u}).catch(h=>{throw Error.captureStackTrace(h),h}),r.callback=(h,u)=>h?m(h):p(u)}return a&&(l=r.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{r.handleError(p,this.connection)}),l(p),r.callback=()=>{};let m=this._queryQueue.indexOf(r);m>-1&&this._queryQueue.splice(m,1),this._pulseQueryQueue()},a),r.callback=(p,m)=>{clearTimeout(s),l(p,m)}),this._queryable?this._ending?(r.native=this.native,process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"))}),n):(this._queryQueue.push(r),this._pulseQueryQueue(),n):(r.native=this.native,process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"))}),n)};xr.prototype.end=function(i){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,i));let t;return i||(t=new this._Promise(function(r,n){i=a=>a?n(a):r()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),i&&i()})}),t};xr.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};xr.prototype._pulseQueryQueue=function(i){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){i||this.emit("drain");return}this._activeQuery=e,e.submit(this);let t=this;e.once("_done",function(){t._pulseQueryQueue()})};xr.prototype.cancel=function(i){this._activeQuery===i?this.native.cancel(function(){}):this._queryQueue.indexOf(i)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(i),1)};xr.prototype.ref=function(){};xr.prototype.unref=function(){};xr.prototype.setTypeParser=function(i,e,t){return this._types.setTypeParser(i,e,t)};xr.prototype.getTypeParser=function(i,e){return this._types.getTypeParser(i,e)}});var Dw=R((upe,IO)=>{"use strict";IO.exports=TO()});var Yf=R((dpe,Bp)=>{"use strict";var hY=fO(),gY=Mp(),yY=Iw(),vY=tw(),bY=Hc(),wY=vO(),xY=Bf(),{DatabaseError:SY}=kw(),{escapeIdentifier:_Y,escapeLiteral:kY}=Hc(),AY=i=>class extends wY{constructor(t){super(t,i)}},Mw=function(i){this.defaults=gY,this.Client=i,this.Query=this.Client.Query,this.Pool=AY(this.Client),this._pools=[],this.Connection=yY,this.types=Dp(),this.DatabaseError=SY,this.TypeOverrides=xY,this.escapeIdentifier=_Y,this.escapeLiteral=kY,this.Result=vY,this.utils=bY};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Bp.exports=new Mw(Dw()):(Bp.exports=new Mw(hY),Object.defineProperty(Bp.exports,"native",{configurable:!0,enumerable:!1,get(){let i=null;try{i=new Mw(Dw())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Bp.exports,"native",{value:i}),i}}))});var Or,mpe,fpe,hpe,gpe,ype,vpe,bpe,wpe,xpe,Spe,_pe,is,Jf=W(()=>{Or=ut(Yf(),1),mpe=Or.default.Client,fpe=Or.default.Pool,hpe=Or.default.Connection,gpe=Or.default.types,ype=Or.default.Query,vpe=Or.default.DatabaseError,bpe=Or.default.escapeIdentifier,wpe=Or.default.escapeLiteral,xpe=Or.default.Result,Spe=Or.default.TypeOverrides,_pe=Or.default.defaults,is=Or.default});function G(i,e){if(!i||typeof i!="object")return!1;if(i instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,D))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(i).constructor;if(t)for(;t;){if(D in t&&t[D]===e[D])return!0;t=Object.getPrototypeOf(t)}return!1}var D,Ape,ce=W(()=>{D=Symbol.for("drizzle:entityKind"),Ape=Symbol.for("drizzle:hasOwnEntityKind")});var qw,Zf,Xf,eh=W(()=>{ce();qw=class{static[D]="ConsoleLogWriter";write(e){console.log(e)}},Zf=class{static[D]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new qw}logQuery(e,t){let r=t.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),n=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},Xf=class{static[D]="NoopLogger";logQuery(){}}});var Hi,ga=W(()=>{ce();Hi=class{static[D]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}});var ct,Dn=W(()=>{ce();ct=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[D]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var th,Lw=W(()=>{ce();th=class{static[D]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var pn,ih=W(()=>{pn=Symbol.for("drizzle:Name")});var rh,Bw,zw=W(()=>{ce();ih();rh=class{static[D]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:r,columns:n,foreignColumns:a}=e();return{name:r,columns:n,foreignTable:a[0].table,foreignColumns:a}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Bw(e,this)}},Bw=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[D]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),n=t.map(l=>l.name),a=r.map(l=>l.name),s=[this.table[pn],...n,r[0].table[pn],...a];return e??`${s.join("_")}_fk`}}});function nh(i,...e){return i(...e)}var Uw=W(()=>{});function Hw(i,e){return`${i[pn]}_${e.join("_")}_unique`}var $w,EO,Fw,Kw=W(()=>{ce();ih();$w=class{constructor(e,t){this.name=t,this.columns=e}static[D]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Fw(e,this.columns,this.nullsNotDistinctConfig,this.name)}},EO=class{static[D]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new $w(e,this.name)}},Fw=class{constructor(e,t,r,n){this.table=e,this.columns=t,this.name=n??Hw(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=r}static[D]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function PO(i,e,t){for(let r=e;r<i.length;r++){let n=i[r];if(n==="\\"){r++;continue}if(n==='"')return[i.slice(e,r).replace(/\\/g,""),r+1];if(!t&&(n===","||n==="}"))return[i.slice(e,r).replace(/\\/g,""),r]}return[i.slice(e).replace(/\\/g,""),i.length]}function CO(i,e=0){let t=[],r=e,n=!1;for(;r<i.length;){let a=i[r];if(a===","){(n||r===e)&&t.push(""),n=!0,r++;continue}if(n=!1,a==="\\"){r+=2;continue}if(a==='"'){let[p,m]=PO(i,r+1,!0);t.push(p),r=m;continue}if(a==="}")return[t,r+1];if(a==="{"){let[p,m]=CO(i,r+1);t.push(p),r=m;continue}let[s,l]=PO(i,r,!1);t.push(s),r=l
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs

OpenAI Integration initialized successfully (GPT-4o)
6:00:31 PM [express] serving on port 5000
6:01:15 PM [express] GET /api/settings/popupAppearance 304 in 13ms :: {"key":"popupAppearance"}
6:01:17 PM [express] GET /api/platform-admin/session 304 in 3ms :: {"authenticated":false}
6:01:17 PM [express] GET /api/subscription-plans 304 in 10ms :: [{"id":1,"code":"trial","name":"Deneme","description":"14 günlük ücretsiz deneme","priceTl":0,"priceUsd":0,"yearlyPriceTl":0,"yearlyPriceUsd":0,"yearlyDiscountPct":20,"trialDays":14,"maxActivities":3,"maxReservationsPerMonth":50,"maxDailyReservations":5,"maxUsers":1,"maxWhatsappNumbers":1,"maxDailyMessages":50,"features":"[\"basic_calendar\",\"manual_reservations\"]","sortOrder":0,"isActive":true,"isPopular":false,"createdAt":"2026-01-05T05:23:25.862Z","updatedAt":"2026-01-05T05:23:25.862Z"},{"id":2,"code":"basic","name":"Basic","description":"Küçük işletmeler için temel paket","priceTl":99900,"priceUsd":2900,"yearlyPriceTl":959000,"yearlyPriceUsd":27900,"yearlyDiscountPct":20,"trialDays":0,"maxActivities":5,"maxReservationsPerMonth":200,"maxDailyReservations":20,"maxUsers":2,"maxWhatsappNumbers":1,"maxDailyMessages":200,"features":"[\"basic_calendar\",\"manual_reservations\",\"whatsapp_notifications\",\"basic_reports\"]","sortOrder":1,"isActive":true,"isPopular":false,"createdAt":"2026-01-05T05:23:25.882Z","updatedAt":"2026-01-05T05:23:25.882Z"},{"id":3,"code":"professional","name":"Professional","description":"Büyüyen işletmeler için gelişmiş özellikler","priceTl":249900,"priceUsd":6900,"yearlyPriceTl":2399000,"yearlyPriceUsd":66300,"yearlyDiscountPct":20,"trialDays":0,"maxActivities":20,"maxReservationsPerMonth":1000,"maxDailyReservations":100,"maxUsers":5,"maxWhatsappNumbers":3,"maxDailyMessages":1000,"features":"[\"basic_calendar\",\"manual_reservations\",\"whatsapp_notifications\",\"advanced_reports\",\"ai_bot\",\"woocommerce\",\"package_tours\"]","sortOrder":2,"isActive":true,"isPopular":true,"createdAt":"2026-01-05T05:23:25.887Z","updatedAt":"2026-01-05T05:23:25.887Z"},{"id":4,"code":"enterprise","name":"Enterprise","description":"Büyük ölçekli operasyonlar için sınırsız erişim","priceTl":499900,"priceUsd":14900,"yearlyPriceTl":4799000,"yearlyPriceUsd":143000,"yearlyDiscountPct":20,"trialDays":0,"maxActivities":9999,"maxReservationsPerMonth":99999,"maxDailyReservations":9999,"maxUsers":99,"maxWhatsappNumbers":10,"maxDailyMessages":10000,"features":"[\"basic_calendar\",\"manual_reservations\",\"whatsapp_notifications\",\"advanced_reports\",\"ai_bot\",\"woocommerce\",\"package_tours\",\"api_access\",\"priority_support\",\"custom_branding\"]","sortOrder":3,"isActive":true,"isPopular":false,"createdAt":"2026-01-05T05:23:25.891Z","updatedAt":"2026-01-05T05:23:25.891Z"}]
6:01:17 PM [express] GET /api/plan-features 304 in 8ms :: [{"id":1,"key":"basic_calendar","label":"Temel Takvim","description":"Rezervasyon takvimi görüntüleme","icon":"Calendar","category":"core","sortOrder":0,"isActive":true,"createdAt":"2026-01-05T06:49:07.883Z"},{"id":2,"key":"manual_reservations","label":"Manuel Rezervasyon","description":"Manuel rezervasyon oluşturma","icon":"ClipboardList","category":"core","sortOrder":1,"isActive":true,"createdAt":"2026-01-05T06:49:07.898Z"},{"id":3,"key":"whatsapp_notifications","label":"WhatsApp Bildirimleri","description":"WhatsApp üzerinden bildirim gönderme","icon":"MessageCircle","category":"communication","sortOrder":2,"isActive":true,"createdAt":"2026-01-05T06:49:07.902Z"},{"id":4,"key":"basic_reports","label":"Temel Raporlar","description":"Basit istatistik raporları","icon":"BarChart3","category":"analytics","sortOrder":3,"isActive":true,"createdAt":"2026-01-05T06:49:07.905Z"},{"id":5,"key":"advanced_reports","label":"Gelişmiş Raporlar","description":"Detaylı analiz ve raporlama","icon":"TrendingUp","category":"analytics","sortOrder":4,"isActive":true,"createdAt":"2026-01-05T06:49:07.909Z"},{"id":6,"key":"ai_bot","label":"AI Bot","description":"Yapay zeka destekli müşteri yanıtları","icon":"Bot","category":"automation","sortOrder":5,"isActive":true,"createdAt":"2026-01-05T06:49:07.913Z"},{"id":7,"key":"woocommerce","label":"WooCommerce Entegrasyonu","description":"E-ticaret sitesi entegrasyonu","icon":"ShoppingCart","category":"integration","sortOrder":6,"isActive":true,"createdAt":"2026-01-05T06:49:07.918Z"},{"id":8,"key":"package_tours","label":"Paket Turlar","description":"Çoklu aktivite paket turları","icon":"Package","category":"core","sortOrder":7,"isActive":true,"createdAt":"2026-01-05T06:49:07.923Z"},{"id":9,"key":"api_access","label":"API Erişimi","description":"Dış sistemler için API erişimi","icon":"Code","category":"integration","sortOrder":8,"isActive":true,"createdAt":"2026-01-05T06:49:07.927Z"},{"id":10,"key":"priority_support","label":"Öncelikli Destek","description":"7/24 öncelikli teknik destek","icon":"HeadphonesIcon","category":"support","sortOrder":9,"isActive":true,"createdAt":"2026-01-05T06:49:07.931Z"},{"id":11,"key":"custom_branding","label":"Özel Marka","description":"Kendi logonuz ve renk temanız","icon":"Palette","category":"customization","sortOrder":10,"isActive":true,"createdAt":"2026-01-05T06:49:07.939Z"}]
6:01:17 PM [express] GET /api/subscriptions 304 in 13ms :: []
6:01:17 PM [express] GET /api/settings/popupAppearance 304 in 5ms :: {"key":"popupAppearance"}
6:01:17 PM [express] GET /api/subscription-payments 304 in 5ms :: []
6:01:21 PM [express] POST /api/bot-rules/login 200 in 6ms :: {"success":true,"token":"85caae2ca762ea0cc0cff53d0d3715d03bf173357c4fe5dd228cb777c64ba16d","isPlatformAdmin":true}
6:01:21 PM [express] GET /api/analytics/whatsapp 200 in 12ms :: {"totalMessagesThisMonth":27,"userMessages":15,"botResponses":12,"escalatedConversations":1,"escalationRate":7,"uniqueCustomers":1,"avgResponseTimeMs":0,"botSuccessRate":100}
6:01:21 PM [express] GET /api/analytics/platform 200 in 18ms :: {"totalAgencies":4,"activeAgencies":4,"trialAgencies":0,"paidAgencies":0,"mrrTl":0,"mrrUsd":0,"churnRate":0,"totalReservationsThisMonth":6,"avgReservationsPerAgency":2}
6:01:25 PM [express] GET /api/settings/brandSettings 200 in 4ms :: {"key":"brandSettings"}
6:01:25 PM [express] GET /api/smartur-settings 304 in 3ms :: {"footer":"{\"enabled\": true, \"link_url\": \"https://www.mysmartur.com\", \"logo_url\": \"/smartur-logo.png\"}","footer_logo_url":"/uploads/1769621221069-156607974.png","footer_link_url":"https://www.mysmartur.com","footer_enabled":"true"}
6:02:03 PM [express] GET /api/settings/popupAppearance 304 in 6ms :: {"key":"popupAppearance"}
6:02:06 PM [express] GET /api/settings/popupAppearance 304 in 3ms :: {"key":"popupAppearance"}
[PREVIEW DEBUG] isPreviewMode=true, userId=2, sessionTenantId=10
[PREVIEW DEBUG] isPreviewMode=true, userId=2, sessionTenantId=10
6:02:31 PM [express] GET /api/website/activities 404 in 15ms :: {"error":"Web sitesi bulunamadı","code":"WEBSITE_NOT_FOUND"}
6:02:31 PM [express] GET /api/website/homepage-sections 404 in 27ms :: {"error":"Web sitesi bulunamadı","code":"WEBSITE_NOT_FOUND"}
[PREVIEW DEBUG] isPreviewMode=true, userId=2, sessionTenantId=10
[PREVIEW DEBUG] isPreviewMode=true, userId=2, sessionTenantId=10
6:02:33 PM [express] GET /api/website/activities 404 in 7ms :: {"error":"Web sitesi bulunamadı","code":"WEBSITE_NOT_FOUND"}
6:02:33 PM [express] GET /api/website/homepage-sections 404 in 7ms :: {"error":"Web sitesi bulunamadı","code":"WEBSITE_NOT_FOUND"}
[PREVIEW DEBUG] isPreviewMode=true, userId=2, sessionTenantId=10
[PREVIEW DEBUG] isPreviewMode=true, userId=2, sessionTenantId=10
6:02:35 PM [express] GET /api/website/activities 404 in 5ms :: {"error":"Web sitesi bulunamadı","code":"WEBSITE_NOT_FOUND"}
6:02:35 PM [express] GET /api/website/homepage-sections 404 in 5ms :: {"error":"Web sitesi bulunamadı","code":"WEBSITE_NOT_FOUND"}
[PREVIEW DEBUG] isPreviewMode=true, userId=2, sessionTenantId=10
[PREVIEW DEBUG] isPreviewMode=true, userId=2, sessionTenantId=10
6:05:09 PM [express] GET /api/website/activities 404 in 10ms :: {"error":"Web sitesi bulunamadı","code":"WEBSITE_NOT_FOUND"}
6:05:09 PM [express] GET /api/website/homepage-sections 404 in 11ms :: {"error":"Web sitesi bulunamadı","code":"WEBSITE_NOT_FOUND"}
}return[t,r]}function RO(i){let[e]=CO(i,1);return e}function Gw(i){return`{${i.map(e=>Array.isArray(e)?Gw(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Vw=W(()=>{});var _e,oe,Ww,Zc,Qw,Yw,Ye=W(()=>{Lw();Dn();ce();zw();Uw();Kw();Vw();_e=class extends th{foreignKeyConfigs=[];static[D]="PgColumnBuilder";array(e){return new Qw(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:n})=>nh((a,s)=>{let l=new rh(()=>{let p=a();return{columns:[e],foreignColumns:[p]}});return s.onUpdate&&l.onUpdate(s.onUpdate),s.onDelete&&l.onDelete(s.onDelete),l.build(t)},r,n))}buildExtraConfigColumn(e){return new Ww(e,this.config)}},oe=class extends ct{constructor(e,t){t.uniqueName||(t.uniqueName=Hw(e,[t.name])),super(e,t),this.table=e}static[D]="PgColumn"},Ww=class extends oe{static[D]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},Zc=class{static[D]="IndexedColumn";constructor(e,t,r,n){this.name=e,this.keyAsName=t,this.type=r,this.indexConfig=n}name;keyAsName;type;indexConfig},Qw=class extends _e{static[D]="PgArrayBuilder";constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new Yw(e,this.config,t)}},Yw=class i extends oe{constructor(e,t,r,n){super(e,t),this.baseColumn=r,this.range=n,this.size=t.size}size;static[D]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=RO(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let r=e.map(n=>n===null?null:G(this.baseColumn,i)?this.baseColumn.mapToDriverValue(n,!0):this.baseColumn.mapToDriverValue(n));return t?r:Gw(r)}}});function NO(i){return!!i&&typeof i=="function"&&Jw in i&&i[Jw]===!0}function jO(i,e,t){let r=Object.assign(n=>new Zw(n??"",r),{enumName:i,enumValues:e,schema:t,[Jw]:!0});return r}var Jw,Zw,Xw,ah=W(()=>{ce();Ye();Jw=Symbol.for("drizzle:isPgEnum");Zw=class extends _e{static[D]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new Xw(e,this.config)}},Xw=class extends oe{static[D]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}});var li,Xc,Mn=W(()=>{ce();li=class{static[D]="Subquery";constructor(e,t,r,n=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:n}}},Xc=class extends li{static[D]="WithSubquery"}});var OO,DO=W(()=>{OO="0.39.3"});var ex,tx,At,ya=W(()=>{Uw();DO();At={startActiveSpan(i,e){return ex?(tx||(tx=ex.trace.getTracer("drizzle-orm",OO)),nh((t,r)=>r.startActiveSpan(i,n=>{try{return e(n)}catch(a){throw n.setStatus({code:t.SpanStatusCode.ERROR,message:a instanceof Error?a.message:"Unknown error"}),a}finally{n.end()}}),ex,tx)):e()}}});var Tt,va=W(()=>{Tt=Symbol.for("drizzle:ViewBaseConfig")});function nx(i){return typeof i=="object"&&i!==null&&LO in i}function Sr(i){return i[pn]}function so(i){return`${i[sh]??"public"}.${i[pn]}`}var sh,oh,MO,ix,rx,zp,qO,LO,pe,_r=W(()=>{ce();ih();sh=Symbol.for("drizzle:Schema"),oh=Symbol.for("drizzle:Columns"),MO=Symbol.for("drizzle:ExtraConfigColumns"),ix=Symbol.for("drizzle:OriginalName"),rx=Symbol.for("drizzle:BaseName"),zp=Symbol.for("drizzle:IsAlias"),qO=Symbol.for("drizzle:ExtraConfigBuilder"),LO=Symbol.for("drizzle:IsDrizzleTable"),pe=class{static[D]="Table";static Symbol={Name:pn,Schema:sh,OriginalName:ix,Columns:oh,ExtraConfigColumns:MO,BaseName:rx,IsAlias:zp,ExtraConfigBuilder:qO};[pn];[ix];[sh];[oh];[MO];[rx];[zp]=!1;[LO]=!0;[qO]=void 0;constructor(e,t,r){this[pn]=this[ix]=e,this[sh]=t,this[rx]=r}}});function ax(i){return i!=null&&typeof i.getSQL=="function"}function TY(i){let e={sql:"",params:[]};for(let t of i)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}function zO(i){return typeof i=="object"&&i!==null&&"mapToDriverValue"in i&&typeof i.mapToDriverValue=="function"}function O(i,...e){let t=[];(e.length>0||i.length>0&&i[0]!=="")&&t.push(new ui(i[0]));for(let[r,n]of e.entries())t.push(n,new ui(i[r+1]));return new me(t)}function sx(i,e){return i.map(t=>{if(G(t,ba)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(G(t,kr)&&G(t.value,ba)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}function HO(i){return typeof i=="object"&&i!==null&&FO in i}var BO,ui,me,Up,UO,$O,vde,kr,ba,FO,cr,pi=W(()=>{ce();ah();Mn();ya();va();Dn();_r();BO=class{static[D]="FakePrimitiveParam"};ui=class{static[D]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new me([this])}},me=class i{constructor(e){this.queryChunks=e}static[D]="SQL";decoder=UO;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return At.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:n,escapeName:a,escapeParam:s,prepareTyping:l,inlineParams:p,paramStartIndex:m}=r;return TY(e.map(h=>{if(G(h,ui))return{sql:h.value.join(""),params:[]};if(G(h,Up))return{sql:a(h.value),params:[]};if(h===void 0)return{sql:"",params:[]};if(Array.isArray(h)){let u=[new ui("(")];for(let[c,o]of h.entries())u.push(o),c<h.length-1&&u.push(new ui(", "));return u.push(new ui(")")),this.buildQueryFromSourceParams(u,r)}if(G(h,i))return this.buildQueryFromSourceParams(h.queryChunks,{...r,inlineParams:p||h.shouldInlineParams});if(G(h,pe)){let u=h[pe.Symbol.Schema],c=h[pe.Symbol.Name];return{sql:u===void 0||h[zp]?a(c):a(u)+"."+a(c),params:[]}}if(G(h,ct)){let u=n.getColumnCasing(h);if(t.invokeSource==="indexes")return{sql:a(u),params:[]};let c=h.table[pe.Symbol.Schema];return{sql:h.table[zp]||c===void 0?a(h.table[pe.Symbol.Name])+"."+a(u):a(c)+"."+a(h.table[pe.Symbol.Name])+"."+a(u),params:[]}}if(G(h,cr)){let u=h[Tt].schema,c=h[Tt].name;return{sql:u===void 0||h[Tt].isAlias?a(c):a(u)+"."+a(c),params:[]}}if(G(h,kr)){if(G(h.value,ba))return{sql:s(m.value++,h),params:[h],typings:["none"]};let u=h.value===null?null:h.encoder.mapToDriverValue(h.value);if(G(u,i))return this.buildQueryFromSourceParams([u],r);if(p)return{sql:this.mapInlineParam(u,r),params:[]};let c=["none"];return l&&(c=[l(h.encoder)]),{sql:s(m.value++,u),params:[u],typings:c}}return G(h,ba)?{sql:s(m.value++,h),params:[h],typings:["none"]}:G(h,i.Aliased)&&h.fieldAlias!==void 0?{sql:a(h.fieldAlias),params:[]}:G(h,li)?h._.isWith?{sql:a(h._.alias),params:[]}:this.buildQueryFromSourceParams([new ui("("),h._.sql,new ui(") "),new Up(h._.alias)],r):NO(h)?h.schema?{sql:a(h.schema)+"."+a(h.enumName),params:[]}:{sql:a(h.enumName),params:[]}:ax(h)?h.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([h.getSQL()],r):this.buildQueryFromSourceParams([new ui("("),h.getSQL(),new ui(")")],r):p?{sql:this.mapInlineParam(h,r),params:[]}:{sql:s(m.value++,h),params:[h],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let r=e.toString();return t(r==="[object Object]"?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new i.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Up=class{constructor(e){this.value=e}static[D]="Name";brand;getSQL(){return new me([this])}};UO={mapFromDriverValue:i=>i},$O={mapToDriverValue:i=>i},vde={...UO,...$O},kr=class{constructor(e,t=$O){this.value=e,this.encoder=t}static[D]="Param";brand;getSQL(){return new me([this])}};(i=>{function e(){return new me([])}i.empty=e;function t(p){return new me(p)}i.fromList=t;function r(p){return new me([new ui(p)])}i.raw=r;function n(p,m){let h=[];for(let[u,c]of p.entries())u>0&&m!==void 0&&h.push(m),h.push(c);return new me(h)}i.join=n;function a(p){return new Up(p)}i.identifier=a;function s(p){return new ba(p)}i.placeholder=s;function l(p,m){return new kr(p,m)}i.param=l})(O||(O={}));(i=>{class e{constructor(r,n){this.sql=r,this.fieldAlias=n}static[D]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}i.Aliased=e})(me||(me={}));ba=class{constructor(e){this.name=e}static[D]="Placeholder";getSQL(){return new me([this])}};FO=Symbol.for("drizzle:IsDrizzleView"),cr=class{static[D]="View";[Tt];[FO]=!0;constructor({name:e,schema:t,selectedFields:r,query:n}){this[Tt]={name:e,originalName:e,schema:t,selectedFields:r,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new me([this])}};ct.prototype.getSQL=function(){return new me([this])};pe.prototype.getSQL=function(){return new me([this])};li.prototype.getSQL=function(){return new me([this])}});function $p(i,e){return new Proxy(i,new el(e,!1))}function qn(i,e){return new Proxy(i,new oo(new Proxy(i.table,new el(e,!1))))}function ox(i,e){return new me.Aliased(Fp(i.sql,e),i.fieldAlias)}function Fp(i,e){return O.join(i.queryChunks.map(t=>G(t,ct)?qn(t,e):G(t,me)?Fp(t,e):G(t,me.Aliased)?ox(t,e):t))}var oo,el,KO,ch=W(()=>{Dn();ce();pi();_r();va();oo=class{constructor(e){this.table=e}static[D]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}},el=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[D]="TableAliasProxyHandler";get(e,t){if(t===pe.Symbol.IsAlias)return!0;if(t===pe.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===pe.Symbol.OriginalName)return this.alias;if(t===Tt)return{...e[Tt],name:this.alias,isAlias:!0};if(t===pe.Symbol.Columns){let n=e[pe.Symbol.Columns];if(!n)return n;let a={};return Object.keys(n).map(s=>{a[s]=new Proxy(n[s],new oo(new Proxy(e,this)))}),a}let r=e[t];return G(r,ct)?new Proxy(r,new oo(new Proxy(e,this))):r}},KO=class{constructor(e){this.alias=e}static[D]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?$p(e.sourceTable,this.alias):e[t]}}});var wt,rs=W(()=>{ch();Dn();ce();pi();Mn();va();wt=class i{static[D]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===Tt)return{...e[Tt],selectedFields:new Proxy(e[Tt].selectedFields,this)};if(typeof t=="symbol")return e[t];let n=(G(e,li)?e._.selectedFields:G(e,cr)?e[Tt].selectedFields:e)[t];if(G(n,me.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!n.isSelectionField)return n.sql;let a=n.clone();return a.isSelectionField=!0,a}if(G(n,me)){if(this.config.sqlBehavior==="sql")return n;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return G(n,ct)?this.config.alias?new Proxy(n,new oo(new Proxy(n.table,new el(this.config.alias,this.config.replaceOriginalName??!1)))):n:typeof n!="object"||n===null?n:new Proxy(n,new i(this.config))}}});function GO(i,e,t){let r={},n=i.reduce((a,{path:s,field:l},p)=>{let m;G(l,ct)?m=l:G(l,me)?m=l.decoder:m=l.sql.decoder;let h=a;for(let[u,c]of s.entries())if(u<s.length-1)c in h||(h[c]={}),h=h[c];else{let o=e[p],d=h[c]=o===null?null:m.mapFromDriverValue(o);if(t&&G(l,ct)&&s.length===2){let f=s[0];f in r?typeof r[f]=="string"&&r[f]!==Sr(l.table)&&(r[f]=!1):r[f]=d===null?Sr(l.table):!1}}return a},{});if(t&&Object.keys(r).length>0)for(let[a,s]of Object.entries(r))typeof s=="string"&&!t[s]&&(n[a]=null);return n}function Vr(i,e){return Object.entries(i).reduce((t,[r,n])=>{if(typeof r!="string")return t;let a=e?[...e,r]:[r];return G(n,ct)||G(n,me)||G(n,me.Aliased)?t.push({path:a,field:n}):G(n,pe)?t.push(...Vr(n[pe.Symbol.Columns],a)):t.push(...Vr(n,a)),t},[])}function Hp(i,e){let t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(let[n,a]of t.entries())if(a!==r[n])return!1;return!0}function lh(i,e){let t=Object.entries(e).filter(([,r])=>r!==void 0).map(([r,n])=>G(n,me)||G(n,ct)?[r,n]:[r,new kr(n,i[pe.Symbol.Columns][r])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function VO(i,e){for(let t of e)for(let r of Object.getOwnPropertyNames(t.prototype))r!=="constructor"&&Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}function co(i){return i[pe.Symbol.Columns]}function WO(i){return i[Tt].selectedFields}function wa(i){return G(i,li)?i._.alias:G(i,cr)?i[Tt].name:G(i,me)?void 0:i[pe.Symbol.IsAlias]?i[pe.Symbol.Name]:i[pe.Symbol.BaseName]}function Xe(i,e){return{name:typeof i=="string"&&i.length>0?i:"",config:typeof i=="object"?i:e}}function QO(i){if(typeof i!="object"||i===null||i.constructor.name!=="Object")return!1;if("logger"in i){let e=typeof i.logger;return!(e!=="boolean"&&(e!=="object"||typeof i.logger.logQuery!="function")&&e!=="undefined")}if("schema"in i){let e=typeof i.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in i){let e=typeof i.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in i)return!(i.mode!=="default"||i.mode!=="planetscale"||i.mode!==void 0);if("connection"in i){let e=typeof i.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in i){let e=typeof i.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(i).length===0}var xt=W(()=>{Dn();ce();pi();Mn();_r();va()});var Kp,YO=W(()=>{ce();ga();rs();_r();ya();xt();Kp=class extends Hi{constructor(e,t,r,n){super(),this.session=t,this.dialect=r,this.config={table:e,withList:n}}static[D]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[pe.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Vr(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return At.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>At.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new wt({alias:Sr(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function IY(i){return(i.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function EY(i){return(i.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,r,n)=>{let a=n===0?r.toLowerCase():`${r[0].toUpperCase()}${r.slice(1)}`;return t+a},"")}function PY(i){return i}var uh,JO=W(()=>{ce();_r();uh=class{static[D]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?IY:e==="camelCase"?EY:PY}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[pe.Symbol.Schema]??"public",r=e.table[pe.Symbol.OriginalName],n=`${t}.${r}.${e.name}`;return this.cache[n]||this.cacheTable(e.table),this.cache[n]}cacheTable(e){let t=e[pe.Symbol.Schema]??"public",r=e[pe.Symbol.OriginalName],n=`${t}.${r}`;if(!this.cachedTables[n]){for(let a of Object.values(e[pe.Symbol.Columns])){let s=`${n}.${a.name}`;this.cache[s]=this.convert(a.name)}this.cachedTables[n]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Gp,ph,dh=W(()=>{ce();Gp=class extends Error{static[D]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},ph=class extends Gp{static[D]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var xa,Vp=W(()=>{ce();Ye();xa=class extends _e{static[D]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function ZO(i,e){let{name:t,config:r}=Xe(i,e);return r.mode==="number"?new cx(t):new ux(t)}var cx,lx,ux,px,dx=W(()=>{ce();xt();Ye();Vp();cx=class extends xa{static[D]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new lx(e,this.config)}},lx=class extends oe{static[D]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},ux=class extends xa{static[D]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new px(e,this.config)}},px=class extends oe{static[D]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function XO(i,e){let{name:t,config:r}=Xe(i,e);return r.mode==="number"?new mx(t):new hx(t)}var mx,fx,hx,gx,yx=W(()=>{ce();xt();Ye();mx=class extends _e{static[D]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new fx(e,this.config)}},fx=class extends oe{static[D]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},hx=class extends _e{static[D]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new gx(e,this.config)}},gx=class extends oe{static[D]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function we(i){return new vx(i??"")}var vx,bx,wx=W(()=>{ce();Ye();vx=class extends _e{static[D]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new bx(e,this.config)}},bx=class extends oe{static[D]="PgBoolean";getSQLType(){return"boolean"}}});function e4(i,e={}){let{name:t,config:r}=Xe(i,e);return new xx(t,r)}var xx,Sx,_x=W(()=>{ce();xt();Ye();xx=class extends _e{static[D]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Sx(e,this.config)}},Sx=class extends oe{static[D]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function t4(i){return new kx(i??"")}var kx,Ax,Tx=W(()=>{ce();Ye();kx=class extends _e{static[D]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new Ax(e,this.config)}},Ax=class extends oe{static[D]="PgCidr";getSQLType(){return"cidr"}}});function i4(i){return(e,t)=>{let{name:r,config:n}=Xe(e,t);return new Ix(r,n,i)}}var Ix,Ex,Px=W(()=>{ce();xt();Ye();Ix=class extends _e{static[D]="PgCustomColumnBuilder";constructor(e,t,r){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new Ex(e,this.config)}},Ex=class extends oe{static[D]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var Ln,mh=W(()=>{ce();pi();Ye();Ln=class extends _e{static[D]="PgDateColumnBaseBuilder";defaultNow(){return this.default(O`now()`)}}});function r4(i,e){let{name:t,config:r}=Xe(i,e);return r?.mode==="date"?new Cx(t):new Rx(t)}var Cx,Wp,Rx,Qp,Nx=W(()=>{ce();xt();Ye();mh();Cx=class extends Ln{static[D]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Wp(e,this.config)}},Wp=class extends oe{static[D]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},Rx=class extends Ln{static[D]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Qp(e,this.config)}},Qp=class extends oe{static[D]="PgDateString";getSQLType(){return"date"}}});function n4(i){return new jx(i??"")}var jx,Ox,Dx=W(()=>{ce();Ye();jx=class extends _e{static[D]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Ox(e,this.config)}},Ox=class extends oe{static[D]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function a4(i){return new Mx(i??"")}var Mx,qx,Lx=W(()=>{ce();Ye();Mx=class extends _e{static[D]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new qx(e,this.config)}},qx=class extends oe{static[D]="PgInet";getSQLType(){return"inet"}}});function q(i){return new Bx(i??"")}var Bx,zx,Ux=W(()=>{ce();Ye();Vp();Bx=class extends xa{static[D]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new zx(e,this.config)}},zx=class extends oe{static[D]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function s4(i,e={}){let{name:t,config:r}=Xe(i,e);return new $x(t,r)}var $x,Fx,Hx=W(()=>{ce();xt();Ye();$x=class extends _e{static[D]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new Fx(e,this.config)}},Fx=class extends oe{static[D]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}});function o4(i){return new Kx(i??"")}var Kx,Yp,Gx=W(()=>{ce();Ye();Kx=class extends _e{static[D]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Yp(e,this.config)}},Yp=class extends oe{static[D]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function c4(i){return new Vx(i??"")}var Vx,Jp,Wx=W(()=>{ce();Ye();Vx=class extends _e{static[D]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new Jp(e,this.config)}},Jp=class extends oe{static[D]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function l4(i,e){let{name:t,config:r}=Xe(i,e);return!r?.mode||r.mode==="tuple"?new Qx(t):new Jx(t)}var Qx,Yx,Jx,Zx,Xx=W(()=>{ce();xt();Ye();Qx=class extends _e{static[D]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Yx(e,this.config)}},Yx=class extends oe{static[D]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r),Number.parseFloat(n)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Jx=class extends _e{static[D]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new Zx(e,this.config)}},Zx=class extends oe{static[D]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,n]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(r),c:Number.parseFloat(n)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function u4(i){return new e0(i??"")}var e0,t0,i0=W(()=>{ce();Ye();e0=class extends _e{static[D]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new t0(e,this.config)}},t0=class extends oe{static[D]="PgMacaddr";getSQLType(){return"macaddr"}}});function p4(i){return new r0(i??"")}var r0,n0,a0=W(()=>{ce();Ye();r0=class extends _e{static[D]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new n0(e,this.config)}},n0=class extends oe{static[D]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function d4(i,e){let{name:t,config:r}=Xe(i,e);return new s0(t,r?.precision,r?.scale)}var s0,Zp,o0=W(()=>{ce();xt();Ye();s0=class extends _e{static[D]="PgNumericBuilder";constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new Zp(e,this.config)}},Zp=class extends oe{static[D]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}});function m4(i,e){let{name:t,config:r}=Xe(i,e);return!r?.mode||r.mode==="tuple"?new c0(t):new u0(t)}var c0,l0,u0,p0,d0=W(()=>{ce();xt();Ye();c0=class extends _e{static[D]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new l0(e,this.config)}},l0=class extends oe{static[D]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},u0=class extends _e{static[D]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new p0(e,this.config)}},p0=class extends oe{static[D]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,r]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(r)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function CY(i){let e=[];for(let t=0;t<i.length;t+=2)e.push(Number.parseInt(i.slice(t,t+2),16));return new Uint8Array(e)}function f4(i,e){let t=new ArrayBuffer(8),r=new DataView(t);for(let n=0;n<8;n++)r.setUint8(n,i[e+n]);return r.getFloat64(0,!0)}function m0(i){let e=CY(i),t=0,r=e[t];t+=1;let n=new DataView(e.buffer),a=n.getUint32(t,r===1);t+=4;let s;if(a&536870912&&(s=n.getUint32(t,r===1),t+=4),(a&65535)===1){let l=f4(e,t);t+=8;let p=f4(e,t);return t+=8,[l,p]}throw new Error("Unsupported geometry type")}var h4=W(()=>{});function g4(i,e){let{name:t,config:r}=Xe(i,e);return!r?.mode||r.mode==="tuple"?new f0(t):new g0(t)}var f0,h0,g0,y0,v0=W(()=>{ce();xt();Ye();h4();f0=class extends _e{static[D]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new h0(e,this.config)}},h0=class extends oe{static[D]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return m0(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},g0=class extends _e{static[D]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new y0(e,this.config)}},y0=class extends oe{static[D]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=m0(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function y4(i){return new b0(i??"")}var b0,w0,x0=W(()=>{ce();Ye();b0=class extends _e{static[D]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new w0(e,this.config)}},w0=class extends oe{static[D]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function be(i){return new S0(i??"")}var S0,_0,k0=W(()=>{ce();Ye();S0=class extends _e{static[D]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new _0(e,this.config)}},_0=class extends oe{static[D]="PgSerial";getSQLType(){return"serial"}}});function v4(i){return new A0(i??"")}var A0,T0,I0=W(()=>{ce();Ye();Vp();A0=class extends xa{static[D]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new T0(e,this.config)}},T0=class extends oe{static[D]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function b4(i){return new E0(i??"")}var E0,P0,C0=W(()=>{ce();Ye();E0=class extends _e{static[D]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new P0(e,this.config)}},P0=class extends oe{static[D]="PgSmallSerial";getSQLType(){return"smallserial"}}});function k(i,e={}){let{name:t,config:r}=Xe(i,e);return new R0(t,r)}var R0,N0,j0=W(()=>{ce();xt();Ye();R0=class extends _e{static[D]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new N0(e,this.config)}},N0=class extends oe{static[D]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function w4(i,e={}){let{name:t,config:r}=Xe(i,e);return new O0(t,r.withTimezone??!1,r.precision)}var O0,Xp,D0=W(()=>{ce();xt();Ye();mh();O0=class extends Ln{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}static[D]="PgTimeBuilder";build(e){return new Xp(e,this.config)}},Xp=class extends oe{static[D]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function X(i,e={}){let{name:t,config:r}=Xe(i,e);return r?.mode==="string"?new q0(t,r.withTimezone??!1,r.precision):new M0(t,r?.withTimezone??!1,r?.precision)}var M0,ed,q0,td,L0=W(()=>{ce();xt();Ye();mh();M0=class extends Ln{static[D]="PgTimestampBuilder";constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new ed(e,this.config)}},ed=class extends oe{static[D]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},q0=class extends Ln{static[D]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new td(e,this.config)}},td=class extends oe{static[D]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function x4(i){return new B0(i??"")}var B0,id,z0=W(()=>{ce();pi();Ye();B0=class extends _e{static[D]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(O`gen_random_uuid()`)}build(e){return new id(e,this.config)}},id=class extends oe{static[D]="PgUUID";getSQLType(){return"uuid"}}});function S4(i,e={}){let{name:t,config:r}=Xe(i,e);return new U0(t,r)}var U0,$0,F0=W(()=>{ce();xt();Ye();U0=class extends _e{static[D]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new $0(e,this.config)}},$0=class extends oe{static[D]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function _4(i,e){let{name:t,config:r}=Xe(i,e);return new H0(t,r)}var H0,K0,G0=W(()=>{ce();xt();Ye();H0=class extends _e{static[D]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new K0(e,this.config)}},K0=class extends oe{static[D]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function k4(i,e){let{name:t,config:r}=Xe(i,e);return new V0(t,r)}var V0,W0,Q0=W(()=>{ce();xt();Ye();V0=class extendsnpm warn config production Use `--omit=dev` instead.
error: column "hide_from_website" does not exist
    at /app/dist/index.cjs:70:13330
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async /app/dist/index.cjs:76:37968
    at async zS.getActivities (/app/dist/index.cjs:110:37244)
    at async Ioe (/app/dist/index.cjs:942:28020) {
  length: 118,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '560',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3716',
  routine: 'errorMissingColumn'
}
